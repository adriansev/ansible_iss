---
- include_tasks: pkg_yum-utils_task.yml

- name: Import WLCG key
  ansible.builtin.rpm_key:
    state: present
    key: http://linuxsoft.cern.ch/wlcg/RPM-GPG-KEY-wlcg
  when: _wlcg_key_imported is undefined
  register: _wlcg_key_imported

- name: Install WLCG repository EL7
  ansible.builtin.yum:
    name: http://linuxsoft.cern.ch/wlcg/centos7/x86_64/wlcg-repo-1.0.0-1.el7.noarch.rpm
    state: present
  register: _wlcg_repo_el7_installed
  when: _wlcg_repo_el7_installed is undefined and ( ansible_facts[ 'distribution' ] == 'CentOS' and ansible_facts[ 'distribution_major_version' ] == '7' )
  tags: repo

- name: Install WLCG repository EL9
  ansible.builtin.dnf:
    name: http://linuxsoft.cern.ch/wlcg/el9/x86_64/wlcg-repo-1.0.0-1.el9.noarch.rpm
    state: present
  register: _wlcg_repo_el9_installed
  when: _wlcg_repo_el7_installed is undefined and ( ansible_facts[ 'distribution' ] == 'AlmaLinux' and ansible_facts[ 'distribution_major_version' ] == '9' )
  tags: repo

